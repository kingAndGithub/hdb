{% extends "blogapp/index.html" %}
{% load static %}
{% block extracss %}
    <link rel="shortcut icon" type="image/x-icon" href="{% static "images/favicon.ico" %}" />
  <link rel="stylesheet" media="all" href="{% static "assets/application_bs.css" %}" data-turbolinks-track="true" />
  <script src="{% static "assets/application_bs.js" %}" data-turbolinks-track="true"></script>
  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="MYmzFHzQgm8jhdk3Nzp/x+fd71MTuGoMXHB7UU1iodcsqyz1/FcN714V0sTY5PGNu85MuDPPAQA+BUlyF2wTUA==" />

{% endblock %}
{%  block content %}

<div class="container pb-5" style="padding-left:0;padding-right:0">
    <div class="order_site">
        <nav aria-label="breadcrumb">
  <ol class="breadcrumb breadcrumb-qibao">
    您的位置：
      <li class="breadcrumb-item"><a href="http://qibao360.com/users/home">用户中心</a></li>
      <li class="breadcrumb-item"><a href="http://qibao360.com/users/14585/line_items?state=unfinished">未完成订单</a></li>
    <li class="breadcrumb-item active" aria-current="page">填写投保资料（订单编号：00705839）</li>
  </ol>
</nav>

</div>


<div class="row">
  <div class="offset-2 col-8">
    <table class="table table-borderless">
  <tbody><tr>
    <td class="text-center align-middle"><img height="60" src="./qb360_files/insurance-04-2a07c1387d64111c2d2ad412ebced36356bd4f2cda6a662a0bd43d9eef17fc65.png" alt="Insurance 04"></td>
    <td class="text-center align-middle"><img width="50" height="9" src="./qb360_files/insurance-08-63494f4fbfcab89c610a5bbcb33d888d6ac7ffee9d80581d3f49f183fc2ee65d.png" alt="Insurance 08"></td>
    <td class="text-center align-middle"><img height="60" src="./qb360_files/cover-01-0672fa54ac4246fe03bdfe1913e222ef149b1ad764a29ec435bc05e1fd99dc63.png" alt="Cover 01"></td>
    <td class="text-center align-middle"><img width="50" height="9" src="./qb360_files/insurance-08-63494f4fbfcab89c610a5bbcb33d888d6ac7ffee9d80581d3f49f183fc2ee65d.png" alt="Insurance 08"></td>
    <td class="text-center align-middle"><img height="60" src="./qb360_files/cover-02-3b105b0e2f91b552320057064a47bf7a6b8b5b6f84628db6158780872aa02114.png" alt="Cover 02"></td>
    <td class="text-center align-middle"><img width="50" height="9" src="./qb360_files/insurance-08-63494f4fbfcab89c610a5bbcb33d888d6ac7ffee9d80581d3f49f183fc2ee65d.png" alt="Insurance 08"></td>
    <td class="text-center align-middle"><img height="60" src="./qb360_files/cover-03-c12027847b8fcb8f2b5ca64bee003f04fea18c6bc1f0a2e0e1ff7fd348b822b4.png" alt="Cover 03"></td>
  </tr>
  <tr>
    <td class="text-center align-middle">填写资料</td>
    <td class="text-center align-middle"></td>
    <td class="text-center align-middle">确认并提交</td>
    <td class="text-center align-middle"></td>
    <td class="text-center align-middle">支付</td>
    <td class="text-center align-middle"></td>
    <td class="text-center align-middle">投保成功</td>
  </tr>
</tbody></table>

  </div>
</div>

<div class="row">
  <div class="offset-1 col-10">

    <h5><a target="_blank" href="http://qibao360.com/insurances/131">员工保障计划 C方案</a></h5>


<form class="form-flat" id="edit_insurance_item_114025" enctype="multipart/form-data" action="http://qibao360.com/insurance_items/114025" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="_method" value="patch"><input type="hidden" name="authenticity_token" value="VgzzHcT92i84iWXpXu63r/Gga0/WOcyUvBPZmfoHUdOg2jQ7nO92e6smRDPHya6Fv5+McGx2FVQyCTreElUP9A==">


  <div class="card border-light my-3">
    <h6 class="card-header">保险基本信息</h6>
    <div class="card-body">


  <input readonly="readonly" class="form-control" type="hidden" value="14585" name="insurance_item[line_item_attributes][user_id]" id="insurance_item_line_item_attributes_user_id">
  <input readonly="readonly" class="form-control" type="hidden" value="131" name="insurance_item[line_item_attributes][insurance_id]" id="insurance_item_line_item_attributes_insurance_id">
  <input class="form-control" type="hidden" value="1" name="insurance_item[line_item_attributes][quantity]" id="insurance_item_line_item_attributes_quantity">
  <input type="hidden" value="1.0" name="insurance_item[line_item_attributes][factor]" id="insurance_item_line_item_attributes_factor">
  <input type="hidden" value="personal" name="insurance_item[line_item_attributes][shared_state]" id="insurance_item_line_item_attributes_shared_state">


  <div class="form-group row">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_line_item_attributes_started_at">起保时间</label>
    <div class="col-3">
      <div class="input-group">
          <input  class="form-control form-control-sm datepicker started-date" placeholder="2014-09-22" data-mindays="3" type="text" value="2019-04-09" name="start_date" id="insurance_item_started_at">
      </div>
    </div>
    <div class="col-7">
      <div class="form-row align-items-center">
        <div class="col-auto">
          <select class="form-control form-control-sm started-time" name="insurance_item_time" id="insurance_item_started_time" style="border-color: rgb(235, 235, 235); color: rgb(128, 128, 128);"><option selected="selected" value="0">00</option>
<option value="1">01</option>
<option value="2">02</option>
<option value="3">03</option>
<option value="4">04</option>
<option value="5">05</option>
<option value="6">06</option>
<option value="7">07</option>
<option value="8">08</option>
<option value="9">09</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
<option value="13">13</option>
<option value="14">14</option>
<option value="15">15</option>
<option value="16">16</option>
<option value="17">17</option>
<option value="18">18</option>
<option value="19">19</option>
<option value="20">20</option>
<option value="21">21</option>
<option value="22">22</option>
<option value="23">23</option></select>
        </div>
        <div class="col-auto">
          <span class="form-control-static">时开始
              <span class="green">（工作日15:00前保费到账，可次日生效）</span>
          </span>
        </div>
      </div> <!-- form-row align-items-center -->
    </div>
  </div>

  <div class="form-group row">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_line_item_attributes_stopped_at">终止时间</label>
    <div class="col-3">
      <input class="form-control form-control-sm datepicker stopped-date disabled-state" disabled="disabled" placeholder="2015-09-22" readonly="readonly" type="text" value="2020-04-08" name="stopped_date" id="insurance_item__stopped_at">
    </div>
    <div class="col-5">
      <div class="form-row align-items-center">
        <div class="col-auto">
          <select class="form-control form-control-sm stopped-time " name="insurance_item[line_item_attributes][stopped_time]" id="insurance_item_stopped_time" style="border-color: rgb(235, 235, 235); color: rgb(128, 128, 128);"><option value="1">01</option>
<option value="2">02</option>
<option value="3">03</option>
<option value="4">04</option>
<option value="5">05</option>
<option value="6">06</option>
<option value="7">07</option>
<option value="8">08</option>
<option value="9">09</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
<option value="13">13</option>
<option value="14">14</option>
<option value="15">15</option>
<option value="16">16</option>
<option value="17">17</option>
<option value="18">18</option>
<option value="19">19</option>
<option value="20">20</option>
<option value="21">21</option>
<option value="22">22</option>
<option value="23">23</option>
<option selected="selected" value="24">24</option></select>
        </div>
        <div class="col-auto">
          <span class="form-control-static">时结束</span>
        </div>
      </div> <!-- form-row align-items-center -->
    </div>
  </div>

  <div class="form-group row">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_line_item_attributes_period">保险周期</label>
    <div class="col-3">
      <select class="form-control form-control-sm policy-period" data-mode="month" data-interval="2" style="width:100%" name="insurance_item[line_item_attributes][period]" id="insurance_item_line_item_attributes_period"><option value="1">1 个月</option>
<option value="2">2 个月</option>
<option value="3">3 个月</option>
<option value="4">4 个月</option>
<option value="5">5 个月</option>
<option value="6">6 个月</option>
<option value="7">7 个月</option>
<option value="8">8 个月</option>
<option value="9">9 个月</option>
<option value="10">10 个月</option>
<option value="11">11 个月</option>
<option selected="selected" value="12">1 整年</option></select>
    </div>
  </div>

  <div class="form-group row hidden">    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_line_item_attributes_pay_cycle">付费周期</label>
    <div class="col-3">
      <select class="form-control form-control-sm payment-period" style="width:100%" name="insurance_item[line_item_attributes][pay_cycle]" id="insurance_item_line_item_attributes_pay_cycle"><option selected="selected" value="full">全额付费</option></select>
    </div>
    <div class="col-5">
      <span class="form-text text-muted"><strong>分期付费</strong> 为按自然月分12期付费</span>
    </div>
</div>
  <div class="form-group row hidden">    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_line_item_attributes_charging_mode">增减人计费方式</label>
    <div class="col-3">
      <select class="form-control form-control-sm charging-mode" disabled="disabled" data-mode="monthly" name="insurance_item[line_item_attributes][charging_mode]" id="insurance_item_line_item_attributes_charging_mode" style="border-color: rgb(235, 235, 235); color: rgb(128, 128, 128);"><option selected="selected" value="daily">按天计费</option>
<option value="monthly">按月计费</option></select>
    </div>
</div>

  <div class="form-group row hidden">
    <label class="control-label" for="insurance_item_line_item_attributes_price">购买时价格</label>
    <input class="form-control" readonly="readonly" type="hidden" value="0.0" name="insurance_item[line_item_attributes][price]" id="insurance_item_line_item_attributes_price">
  </div>

  <input disabled="disabled" class="form-control" type="hidden" name="insurance_item[line_item_attributes][slip_no]" id="insurance_item_line_item_attributes_slip_no" style="color: rgb(153, 153, 153);">
  <input type="hidden" value="4" name="insurance_item[line_item_attributes][lock_version]" id="insurance_item_line_item_attributes_lock_version">
<input type="hidden" value="705839" name="insurance_item[line_item_attributes][id]" id="insurance_item_line_item_attributes_id">
    </div>
  </div>


  <!--投保人信息   被保险人信息-->
  <div class="card border-light my-3">  <h6 class="card-header">投保人信息</h6>
  <div class="card-body px-3 py-3">
      <div class="select-contact alert alert-primary" style="background-color:#ddf5ff;font-size:12px" role="alert">
  <h6 class="alert-heading">常用企业：</h6>
  <ul class="list-inline">
  </ul>
</div>


  <div class="form-group row hidden">    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_appli_type">投保人类型</label>
    <div class="col-5">
      <select class="form-control form-control-sm appli-type" name="insurance_item[insurance_business_attributes][appli_type]" id="insurance_item_insurance_business_attributes_appli_type"><option selected="selected" value="02">企业</option>
<option value="01">个人</option></select>
    </div>
</div>
  <div class="form-group row">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_enterprise_name">企业名称／姓名</label>
    <div class="col-5">
      <input class="form-control form-control-sm business-enterprise-name" type="text" name="insurance_item[insurance_business_attributes][enterprise_name]" id="insurance_item_insurance_business_attributes_enterprise_name">
      <div class="invalid-feedback"></div>
    </div>
    <div class="col-4">
      <span class="form-text"></span>
    </div>
  </div>

  <div class="form-group row">    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_card_type_id">证件类型</label>
    <div class="col-5">
      <select class="form-control form-control-sm appli-id-type" style="width:100%" name="insurance_item[insurance_business_attributes][card_type_id]" id="insurance_item_insurance_business_attributes_card_type_id"><option value="">--请选择证件类型--</option>
<option data-code="37" value="15">统一社会信用代码</option>
<option data-code="31" value="14">组织机构代码</option></select>
    </div>
    <div class="col-4">
      <span class="form-text"></span>
    </div>
</div>
    <div class="form-group row">
      <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_code_number">证件号码</label>
      <div class="col-5">
        <input class="form-control form-control-sm business-organization-code" placeholder="统一社会信用代码 (18位) / 组织机构代码证 (9位)" type="text" name="insurance_item[insurance_business_attributes][code_number]" id="insurance_item_insurance_business_attributes_code_number">
        <div class="invalid-feedback"></div>
      </div>
      <div class="col-4">
        <span class="form-text"></span>
      </div>
    </div>

  <div class="form-group row">    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_business_license_id">营业执照</label>
    <div class="col-2">
  <div id="insurance_business_license_preview_id" style="min-height:120px;">  <a target="_blank" href="./qb360_files/79b4261052d4f5afac9da301447ad3c_fc9f3bc0a6.jpg"><img style="width:100%;" src="./qb360_files/79b4261052d4f5afac9da301447ad3c_fc9f3bc0a6.jpg" alt="79b4261052d4f5afac9da301447ad3c fc9f3bc0a6"></a>
</div>
  <div class="form-control-plaintext text-center">
    <a target="_blank" href="http://qibao360.com/files/license_template.jpg">点击查看模版</a>
  </div>
</div>
<div class="col-7">
  <div class="form-group">
    上传：营业执照照片；<br>
    照片所有信息需清晰可见，内容真实有效，不得做任何修改。<br>
    照片支持.jpg .jpeg .gif .png 格式，大小不得超过8M。
  </div>
  <div class="form-group">
    <!--
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#insurance_business_license_modal_id"> 选择文件... </button>
    <a class="" onclick="$('div#insurance_business_license_modal_placeholder_id input[id=business_license_license]').click();"><span class="fa fa-upload"></span> 选择文件...</a>
    -->
    <a class="btn btn-success" onclick="$(&#39;div#insurance_business_license_modal_placeholder_id input[id=business_license_license]&#39;).click();" href="javascript:void(0)">
      <span class="fa fa-upload"></span> 选择文件...
</a>  </div>
  <div class="form-group mb-0">
    <input class="form-control form-control-sm insurance-business-license-id" type="hidden" name="insurance_item[insurance_business_attributes][business_license_id]" id="insurance_item_insurance_business_attributes_business_license_id" value="6463">
    <div id="insurance_business_license_error_id" class="invalid-feedback"></div>
  </div>
</div>

</div>
  <div class="form-group row has-feedback required">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_name">联系人</label>
    <div class="col-5">
      <input class="form-control form-control-sm business-name" type="text" name="insurance_item[insurance_business_attributes][name]" id="insurance_item_insurance_business_attributes_name">
      <div class="invalid-feedback"></div>
    </div>
    <div class="col-4">
      <span class="form-text"></span>
    </div>
  </div>

  <div class="form-group row has-feedback required">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_telephone">联系电话</label>
    <div class="col-5">
      <input class="form-control form-control-sm business-telephone" type="text" name="insurance_item[insurance_business_attributes][telephone]" id="insurance_item_insurance_business_attributes_telephone">
      <div class="invalid-feedback"></div>
    </div>
    <div class="col-4">
      <span class="form-text"></span>
    </div>
  </div>


  <hr>

  <div class="form-group row has-feedback required">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_with_invoice">发票类型</label>
    <div class="col-5">
      <select class="form-control form-control-sm business-with-invoice" name="insurance_item[insurance_business_attributes][with_invoice]" id="insurance_item_insurance_business_attributes_with_invoice"><option value="">--请选择发票类型--</option>
<option value="noneed">无需发票</option>
<option selected="selected" value="plain">增值税普通发票（纸质发票）</option></select>
    </div>
    <div class="col-4">
      <span class="form-text"></span>
    </div>
  </div>

  <div class="form-group-title" style="display: none;">
    <div class="form-group row">
      <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_invoice_title">发票抬头</label>
      <div class="col-5">
        <input value="同投保人企业名称／姓名" class="form-control-plaintext form-control-sm" readonly="readonly" disabled="disabled" type="text" name="insurance_item[insurance_business_attributes][invoice_title]" id="insurance_item_insurance_business_attributes_invoice_title" style="color: rgb(153, 153, 153);">
        <!--
        <div class="form-control-plaintext">与投保人企业名称／姓名</div>
        -->
      </div>
    </div>
  </div>

  <div class="form-group-tax" style="display: none;">
    <div class="form-group row has-feedback required">
      <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_tax_reg_number">纳税人识别号</label>
      <div class="col-5">
        <input class="form-control form-control-sm tax-reg-number" type="text" name="insurance_item[insurance_business_attributes][tax_reg_number]" id="insurance_item_insurance_business_attributes_tax_reg_number">
        <div class="invalid-feedback"></div>
      </div>
      <div class="col-4">
        <p class="form-text"><span style="color:red">开票必填</span>，请查阅 <em><a class="text-primary" target="_blank" href="http://www.chinatax.gov.cn/n810341/n810755/c2644618/content.html">国家税务总局公告</a></em></p>
      </div>
    </div>
  </div>

    <div class="invoice-form-group hidden" style="">
      <div class="form-group row has-feedback">
  <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_tax_reg_address">税务登记地址</label>
  <div class="col-5">
    <input class="form-control form-control-sm" type="text" name="insurance_item[insurance_business_attributes][tax_reg_address]" id="insurance_item_insurance_business_attributes_tax_reg_address">
    <div class="invalid-feedback"></div>
  </div>
  <div class="col-4">
    <span class="form-text"></span>
  </div>
</div>

<div class="form-group row has-feedback">
  <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_tax_reg_telephone">税务登记联系电话</label>
  <div class="col-5">
    <input class="form-control form-control-sm" type="text" name="insurance_item[insurance_business_attributes][tax_reg_telephone]" id="insurance_item_insurance_business_attributes_tax_reg_telephone">
    <div class="invalid-feedback"></div>
  </div>
  <div class="col-4">
    <span class="form-text"></span>
  </div>
</div>

<div class="form-group row has-feedback">
  <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_tax_bank_name">税务开户银行名称</label>
  <div class="col-5">
    <input class="form-control form-control-sm" type="text" name="insurance_item[insurance_business_attributes][tax_bank_name]" id="insurance_item_insurance_business_attributes_tax_bank_name">
    <div class="invalid-feedback"></div>
  </div>
  <div class="col-4">
    <span class="form-text"></span>
  </div>
</div>

<div class="form-group row has-feedback">
  <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_insurance_business_attributes_tax_bank_account">税务开户银行账号</label>
  <div class="col-5">
    <input class="form-control form-control-sm" type="text" name="insurance_item[insurance_business_attributes][tax_bank_account]" id="insurance_item_insurance_business_attributes_tax_bank_account">
    <div class="invalid-feedback"></div>
  </div>
  <div class="col-4">
    <span class="form-text"></span>
  </div>
</div>

    </div>


  <div class="form-group row">
    <div class="col-8 offset-2">
      <small class="form-text insurance_business_tips" style="display: none;">请提供准确的收货地址和联系人，每月10至13日（节假日顺延）寄送上月纸质发票，如有疑问，请联系工作人员400-11-78360（10:00-18:00）。</small>
  </div>
  </div>

<input type="hidden" value="716897" name="insurance_item[insurance_business_attributes][id]" id="insurance_item_insurance_business_attributes_id">
  </div>
</div>

<div class="card border-light my-3 form-group-address required">
  <h6 class="card-header">邮寄地址</h6>
  <div class="card-body px-3 py-3">


    <!--
    <div class='form-group row'>
      <div class="col-5">
      </div>
      <div class="col-2">
        <span class="help-block"></span>
      </div>
      <div class="col-2 offset-1">
      </div>
    </div>
    -->

    <div class="form-group row">
      <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_line_item_attributes_mailing_item_id">邮寄地址</label>
      <div class="col-8" id="mailing_item_table_placeholder_id">


<script type="text/javascript">

$(".field-mailing-item").click(function(){
  var addr = $(this).data('info');
  $("#mailing_item_info").val(addr);
  $('#mailing_item_info').removeClass('disabled text-danger').addClass('text-success');
  var url = $(this).data('edit');
  $('#mailing_item_edit').attr('href', url);
  $('#mailing_item_edit').removeClass('disabled');
})

</script>

      </div>
      <div class="col-2">
        <a class=" btn btn-outline-success btn-sm btn-block" data-remote="true" href="http://qibao360.com/users/14585/mailing_items/new?line_item_id=705839">新增邮寄地址</a>
      </div>
    </div>

    <div class="form-group row">
      <div class="col-sm-8 offset-2">
          <input type="text" id="mailing_item_info" value="请选择邮寄地址" class="form-control-plaintext text-danger" readonly="readonly">
      </div>
      <div class="col-2">
          <a class="btn btn-outline-success btn-sm btn-block disabled" id="mailing_item_edit" data-remote="true" href="javascript:void(0)">修改选中邮寄信息</a>
      </div>
    </div>
<input type="hidden" value="705839" name="insurance_item[line_item_attributes][id]" id="insurance_item_line_item_attributes_id">
  </div>
</div>


<script type="text/javascript">

$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
  var tab_val = get_element_attr($(e.target), 'href');
  if (tab_val == '#enterprise') {
    $('.appli-type').val('02');
  } else if (tab_val == '#personal') {
    $('.appli-type').val('01');
  }
  $('.appli-type').change();
  e.target // newly activated tab
  e.relatedTarget // previous active tab
})

withInvoiceChange();
</script>




<div class="card border-light my-3 pb-3" style="">

    <h6 class="card-header">被保险人信息</h6>

  <div class="card-body px-3 py-3">


    <div class="select-contact alert alert-primary" style="background-color:#ddf5ff;font-size:12px" role="alert">
  <h6 class="alert-heading">常用职业：</h6>
  <ul class="list-inline">
  </ul>
</div>


  <div class="form-row" style="">
    <label class="col-form-label col-form-label-sm text-right col-2" for="insurance_item_industry_id">行业分类</label>
    <div class="col-auto">

    <!-- category -->
      <!-- 员工意外保障(1), 小企业无忧(25, 26, 27), 创业无忧(28, 29, 30), 上海补充工伤渠道专属(37-42) -->
      <select onchange="vocation_category_options(this.value)" class="form-control form-control-sm" name="insurance_item[category_id]" id="insurance_item_category_id"><option value="">--分类--</option>
<option value="1370">公共管理</option>
<option value="1378">农牧业</option>
<option value="1406">渔业</option>
<option value="1434">林业及农牧渔林服务业</option>
<option value="1477">采矿业</option>
<option value="1511">运输业</option>
<option value="1614">旅游餐饮业</option>
<option value="1634">工程建筑业</option>
<option value="1742">制造业</option>
<option value="2190">印刷及广告业</option>
<option value="2215">医疗卫生业</option>
<option value="2237">娱乐业</option>
<option value="2331">教育业</option>
<option value="2367">教堂寺庙</option>
<option value="2372">公共服务业</option>
<option value="2435">批发零售业</option>
<option value="2465">金融业</option>
<option value="2474">非公共服务业</option>
<option value="2513">家政管理</option>
<option value="2518">执法机构</option>
<option value="2552">现役军人</option>
<option value="2568">运动业</option>
<option value="2658">其他</option></select>
    </div>

    <div class="col-auto">

    <!-- subclass -->

      <!-- 员工意外保障(1), 小企业无忧(25, 26, 27), 创业无忧(28, 29, 30), 上海补充工伤渠道专属(37-42), 雇主保障计划(56-59), 易安补充工伤渠道专属(78-83) -->
      <select onchange="vocation_subclass_options(this.value)" class="form-control form-control-sm" name="insurance_item[subclass_id]" id="insurance_item_subclass_id"><option value="">--子类--</option>
</select>

    </div>

    <div class="col-auto">

    <!-- industry -->

      <!-- 员工意外保障(1), 小企业无忧(25, 26, 27), 创业无忧(28, 29, 30), 上海补充工伤渠道专属(37-42), 雇主保障计划(56-59), 易安补充工伤渠道专属(78-83) -->
      <select class="form-control form-control-sm" style="max-width:350px" name="insurance_item[industry_id]" id="insurance_item_industry_id"><option value="">--职业--</option>
</select>

    </div>

    <div class="col-auto">

    <!-- level -->
    <strong><span id="vocation_level_value" ,="" style="padding-left:10px" data-vocid="798" data-level="1"></span></strong>

    </div> <!-- col-9 -->
  </div> <!-- form-group row -->

  </div> <!-- card-body -->

</div> <!-- card -->


  <div class="card border-light my-3" id="insured_employees">
    <h6 class="card-header">被保险人名单 (<span class="total-insured-number">0</span>)</h6>
    <div class="card-body">

      <div class="insured-list">
  <div class="form-group hidden">
  <div class="col-sm-3">
    <input class="form-control-sm" id="insurance_item_employee_file" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" onchange="onFileChange(this, 10, &#39;#upload_submit_id&#39;)" type="file" name="insurance_item[employee_file]">
  </div>
  <input type="submit" name="import" value="上传名单" class="btn btn-success btn-sm" id="upload_submit_id" data-disable-with="上传名单">
</div>



<script>

    function submitForm(selector) {
        $(selector).click();
    }

    var isIE = /msie/i.test(navigator.userAgent) && !window.opera;
    function onFileChange(target, sizeLimit, submitButtonSelector, not_submit_form, callback) {

        var fileSize = 0;
        if (isIE && !target.files) {
            var filePath = target.value;
            var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
            var file = fileSystem.GetFile(filePath);
            fileSize = file.Size;
        } else {
            fileSize = target.files[0].size;
        }
        var size = fileSize / 1024;
        if (size > sizeLimit * 1000) {
            return alert("附件不能大于" + sizeLimit + "M");
        }

        if (!not_submit_form){
            submitForm(submitButtonSelector);
        }

        if(callback){
            callback();
        }
    }

</script>




  <div id="form_employees_operation_id">
      <a class="btn btn-outline-success btn-sm" data-remote="true" href="http://qibao360.com/insurance_items/114025/insured_employees/new">
    <i class="fa fa-ellipsis-h"></i> 逐个添加
</a>  <a class="btn btn-outline-success btn-sm" onclick="$(&#39;#insurance_item_employee_file&#39;).click();" href="javascript:void(0)">
    <i class="fa fa-list-ul"></i> 上传表格
</a>

<!--
-->

<button name="destroy_all" type="submit" value="destroy_all" form="insured_employees_destroy_all" class="btn btn-outline-danger btn-sm" data-confirm="您确定要删除的所有选中的人员吗？">
  <span class="glyphicon glyphicon-erase" aria-hidden="true"></span> 批量删除
</button>


<a class="btn btn-success btn-sm download float-right" href="http://qibao360.com/files/download?filename=insurant.xls&amp;newname=%E4%BC%81%E4%BF%9D360%E6%8A%95%E4%BF%9D%E8%A1%A8%E6%A0%BC%E6%A8%A1%E7%89%88.xls">
  <i class="fa fa-download"></i> 下载Excel投保模版
</a>
  </div>

  <hr>

  <div class="row">
    <div class="col-5">
      <div style="height: 30px;line-height: 20px;padding: 5px 10px; background-color:#e5f6ec;font-size: 12px;">
        共 <span id="total_insured_number" class="total-insured-number" style="font-weight:bold;color:red;">0</span> 人参保，其中 <span id="error_insured_number" class="error-insured-number" style="font-weight:bold;color:red;">0</span> 人信息有误
      </div>
    </div>
    <div class="col-3">
        <p id="filter_insured_block" class="hidden" style="height: 30px;line-height: 20px;margin-right:-25px;padding: 5px 10px; background-color:#e5f6ec;font-size: 12px; text-align: right;">
        共 <span id="filter_insured_number">0</span> 人满足条件
        </p>
    </div>
    <div class="col-4">
        <div class="input-group">
              <select name="insurance_item_filter_flag" id="insurance_item_filter_flag" class="filter-flag-field custom-select col-3"><option value="">全部</option><option value="incumbent">在职</option>
<option value="resigned">离职</option></select>
          <input type="text" name="insurance_item_filter_value" id="insurance_item_filter_value" class="form-control filter-text-field" placeholder="姓名 / 身份证号码" style="font-size:14px">
          <div class="input-group-append">
            <a class="btn btn-dark" id="filter_submit_id" data-remote="true" rel="nofollow" data-method="post" href="http://qibao360.com/insurance_items/114025/insured_employees/filter">
              <i class="fa fa-search"></i> 搜索
</a>          </div>
        </div><!-- /input-group -->
    </div>
  </div>

  <div style="margin-bottom:15px;padding-bottom:15px;border-bottom: solid 1px #f0f0f0;">
  </div>

  <div id="insured_employee_table_placeholder_id">
    <!--
<div>
</div>
-->






<div class="card" style="border-color:#eff8ef">
  <div class="card-header">
    共 <strong>0</strong> 人参与投保
  </div>

<table class="table">
  <thead>
    <tr>
      <th style="text-align:center"><input type="checkbox" name="checkbox_all" id="checkbox_all" value="1"> 全选</th>
      <th style="text-align:center">姓名</th>
      <th style="text-align:center">证件类别</th>
      <th style="text-align:center">证件号码</th>
      <th style="text-align:center">性别</th>
      <th style="text-align:center">出生日期</th>
      <th style="text-align:center">年龄</th>
        <th style="text-align:center">职业类别</th>
      <th style="text-align:center">操作</th>
    </tr>
  </thead>

  <tbody align="center">
  </tbody>
</table>

<div class="pagesWrap clearfix">

</div>

<div class="pagesWrap clearfix" style="font-size:12px">
</div>

</div> <!-- panel -->

<script type="text/javascript">
// jquery < 1.6 bug

$(document).ready(function() {
  $("#checkbox_all_with_error").click(function(){
    if (this.checked){
      $(".checkbox_employee_with_error").prop("checked", true);
    } else {
      $(".checkbox_employee_with_error").prop("checked", false);
    }
  })
  $("#checkbox_all").click(function(){
    if (this.checked){
      $(".checkbox_employee").prop("checked", true);
    } else {
      $(".checkbox_employee").prop("checked", false);
    }
  })

  $(function () { $("[data-toggle='tooltip']").tooltip(); });

  function show_actions(tr_act, tr_err) {
    tr_act.addClass("insured-employee-focus");
    tr_act.find("a.btn-grid-edit").addClass("btn-success").removeClass("green");
    tr_act.find("a.grid-delete").addClass("btn-danger").removeClass("red");
    tr_err.find(".insured-employee-error-edit").css("visibility", "visible");
  }

  function hide_actions(tr_act, tr_err) {
    tr_act.removeClass("insured-employee-focus");
    tr_act.find("a.btn-grid-edit").removeClass("btn-success").addClass("green");
    tr_act.find("a.grid-delete").removeClass("btn-danger").addClass("red");
    tr_err.find(".insured-employee-error-edit").css("visibility", "hidden");
  }

  $('tr.insured-employee-content').hover(function() {
    tr_act = $(this);
    tr_err = $(this).next("tr.insured-employee-error");
    show_actions(tr_act, tr_err);
    console.log("hover");
  },
  function() {
    tr_act = $(this);
    tr_err = $(this).next("tr.insured-employee-error");
    hide_actions(tr_act, tr_err);
    console.log("hover out");
  })

  $('tr.insured-employee-error').hover(function() {
    tr_err = $(this);
    tr_act = $(this).prev("tr.insured-employee-content");
    show_actions(tr_act, tr_err);
  },
  function() {
    tr_err = $(this);
    tr_act = $(this).prev("tr.insured-employee-content");
    hide_actions(tr_act, tr_err);
  })
})

</script>

  </div>
</div>

    </div>
  </div>

  <div class="insurant_center mt-4">
        <a class="btn btn-outline-danger btn-sm float-left ml-3" style="margin-top:14px" data-confirm="您确定要删除该订单吗？" rel="nofollow" data-method="put" href="http://qibao360.com/line_items/705839/cancel">删除订单</a>
<input type="submit" name="commit" value="保存订单" class="btn btn-outline-success btn-sm float-left ml-3" style="margin-top:14px" data-disable-with="保存订单">


<input type="submit" name="quote" value="报价" class="hidden" id="quote_submit_id" data-disable-with="报价">
<input type="submit" name="level" value="职业类别" class="hidden" id="level_submit_id" data-disable-with="职业类别">

<input type="submit" name="validate" value="下一步" class="float-right insurant_btn_next" data-disable-with="下一步">

    <div id="price_placeholder_id">
      <div class="auto-price">
  <span>共 <span class="insurant_digi right-insured-number" id="insurant_number_bottom">0</span> 人参与投保</span>
  <span class="auto-price-zongji">总计：</span>
  <span class="auto-price-unit">￥</span>
  <span class="auto-price-value" id="total_price">0.00</span>
</div>

    </div>
  </div>

</form>
<script type="text/javascript">

  var category_id = '#insurance_item_category_id';
  var subclass_id = '#insurance_item_subclass_id';
  var industry_id = '#insurance_item_industry_id';
  var option_id   = '#insurance_item_option_id';
  var period_id   = '#insurance_item_line_item_attributes_period';
  var pay_cycle_id  = '#insurance_item_line_item_attributes_pay_cycle';
  var charging_id  = '#insurance_item_line_item_attributes_charging_mode';
  var started_id  = '#insurance_item_line_item_attributes_started_at';
  var stopped_id  = '#insurance_item_line_item_attributes_stopped_at';
  var changed_id  = '#insurance_item_line_item_attributes_changed_on';
  var price_id    = '#insurance_item_line_item_attributes_price';
  var insurance_id = '#insurance_item_line_item_attributes_insurance_id';
  var started_time_id = '#insurance_item_line_item_attributes_started_time';
  var stopped_time_id = '#insurance_item_line_item_attributes_stopped_time';
  var lock_version_id = '#insurance_item_line_item_attributes_lock_version';
  var retroactive_id  = '#insurance_item_line_item_attributes_with_retroactive_period';
  var update_price_url = '/insurance_items/114025/update_price';
  var change_vocation_url = '/insurance_items/114025/change_vocation';
  var change_industries_url = '/line_items/705839/industries';
  var filter_url = '/insurance_items/114025/insured_employees/filter';
  var filter_text_id = '#insurance_item_filter_value';
  var filter_flag_id = '#insurance_item_filter_flag';
  var appli_type_id   = '#insurance_item_insurance_business_attributes_appli_type';
  var appli_id_type_id   = '#insurance_item_insurance_business_attributes_card_type_id';
  var appli_id_no_id   = '#insurance_item_insurance_business_attributes_code_number';
  var appli_invoice_id   = '#insurance_item_insurance_business_attributes_with_invoice';

  function vocation_category_options(value){
    $.ajax({
      type: "POST",
      url:'/locations/vocation_subclasses?vocation_id='+value,
      data:'text',
      success: function(data){
        $(subclass_id).html(data);
        $(subclass_id).change();
      }
    })
  }

  function vocation_subclass_options(value){
    $.ajax({
      type: "POST",
      url: change_industries_url,
      data: { vocation_id: value },
      success: function(data){
        $(industry_id).html(data);
        $(industry_id).change();
      }
    })
  }

  $(industry_id).on("change", function(event) {
    $.ajax({
      type: "POST",
      url:'/locations/vocation_level?employer_vocation_id='+$(this).val(),
      data:'text',
      success: function(level){
        var vocid = get_selected_value( $(industry_id) );
        var indid = vocid;

      //var level = get_selected_data( $(industry_id) );
        var common_vocid = "#industry_" + vocid;
        if (!is_id_exist(common_vocid)) {
          vocid = $(industry_id).find('option:selected').attr('data-level-id');
        }

        // cache occupation class here, new insurant employee will use it.
        set_element_data( $("#vocation_level_value"), 'vocid', vocid );
        set_element_data( $("#vocation_level_value"), 'level', level );

        $('#vocation_level_value').text(level+"类");

        $.ajax({
          type: "POST",
          url: change_vocation_url + '?industry_id=' + indid,
          data: 'text',
          success: function(data){
            var values = data.split('&');
            $(lock_version_id).val( values[0] );
            $('#total_price').text( values[1] );
            $('td.grid-level').text( values[2] );
          }
        })
      }
    })
  });

  function set_charging_mode(period_val, pay_cycle_val) {
//  var period_val = get_selected_value( $(period_id) );
    var period_unit = get_element_data( $(period_id), 'mode' );
      console.log(period_val);
      console.log(period_unit);
    if (period_unit == 'month') {
      var charging_mode = 'daily';
//    var pay_cycle_val = $(pay_cycle_id).val();
      console.log(pay_cycle_val);
      if (pay_cycle_val == 'staging') {
        charging_mode = 'monthly';
      } else {
        console.log(charging_mode);
        if (period_val == '12' && pay_cycle_val == 'full') {
          charging_mode = 'daily';
        } else {
          charging_mode = get_element_data( $(charging_id), 'mode' );
        }
      }
      console.log(charging_mode);
      set_control_value( $(charging_id), charging_mode );
    }
  }

  $(period_id).unbind('change');
  $(period_id).on("change", function(event) {
    // set policy period
    var val_y = $(started_id+'_1i').val();
    if (val_y == null) {
      setStopDate();
    } else {
      var val_m = $(started_id+'_2i').val();
      var val_d = $(started_id+'_3i').val();
      var started_at = new Date(val_y, val_m-1, val_d);
      setStopDateBy(started_at);
    }

    // set charging_mode
    var period_val = get_selected_value( $(period_id) );
    var pay_cycle_val = $(pay_cycle_id).val();
    set_charging_mode(period_val, pay_cycle_val);

    $.ajax({
      type: "POST",
      url: update_price_url + '?update_key=period&update_val=' + period_val,
      data: 'text',
      success: function(data){
        var values = data.split('&');
        $(lock_version_id).val( values[0] );
        $('#total_price').text( values[1] );

        $(charging_id).change();
      }
    })
  });

  $(pay_cycle_id).unbind('change');
  $(pay_cycle_id).on("change", function(event) {
    setStopDate();

    // set charging_mode
    var period_val = get_selected_value( $(period_id) );
    var pay_cycle_val = $(pay_cycle_id).val();
    set_charging_mode(period_val, pay_cycle_val);

    $.ajax({
      type: "POST",
      url: update_price_url + '?update_key=pay_cycle&update_val=' + pay_cycle_val,
      data: 'text',
      success: function(data){
        var values = data.split('&');
        $(lock_version_id).val( values[0] );
        $('#total_price').text( values[1] );

        $(charging_id).change();
      }
    })
  });

  $(charging_id).unbind('change');
  $(charging_id).on("change", function(event) {

    var charging_mode_val = get_selected_value( $(charging_id) );
    $.ajax({
      type: "POST",
      url: update_price_url + '?update_key=charging_mode&update_val=' + charging_mode_val,
      data: 'text',
      success: function(data){
        var values = data.split('&');
        $(lock_version_id).val( values[0] );
        $('#total_price').text( values[1] );
      }
    })
  });

  $('#insurance_item_started_at').unbind('change');
  $('#insurance_item_started_at').on("change", function(event) {
    started_at = $(this).val();
    setStopDate()
  });

  $('#insurance_item_started_time').unbind('change');
  $('#insurance_item_started_time').on("change", function(event) {
    var started_time = $('#insurance_item_started_time').val();

    if (started_time == 0) {
      $('#insurance_item_stopped_time').val(24);
    }
    else {
      $('#insurance_item_stopped_time').val(started_time);
    }

    setStopDate();
  });

  $(stopped_time_id).unbind('change');
  $(stopped_time_id).on("change", function(event) {
    var stopped_time = $(stopped_time_id).val();

    if (stopped_time == 24) {
      $(started_time_id).val(0);
    }
    else {
      $(started_time_id).val(stopped_time);
    }

    setStopDate();
  });

  $(changed_id).unbind('change');
  $(changed_id).on("change", function(event) {

    var changed_on_val = $(changed_id).val();
    $.ajax({
      type: "POST",
      url: update_price_url + '?update_key=changed_on&update_val=' + changed_on_val,
      data: 'text',
      success: function(data){
        var values = data.split('&');
        $(lock_version_id).val( values[0] );
        $('#total_price').text( values[1] );
      }
    })
  });

  $(appli_type_id).unbind('change');
  $(appli_type_id).on("change", function(event) {
    var appli_type_val = $(this).val();

    // appli type select control options
    var id_type_options = "";
    if (appli_type_val == '01') {
    } else if (appli_type_val == '02') {
        id_type_options += '<option data-code=37 value=15>统一社会信用代码</option>';
        id_type_options += '<option data-code=31 value=14>组织机构代码</option>';
    }
    $(appli_id_type_id).html(id_type_options);

    $(appli_id_no_id).change();

    var options = "<option value>--请选择发票类型--</option>"
    if (appli_type_val == '01') {
      options = "<option value>--请选择发票类型--</option><option value='noneed'>无需发票</option>";
    } else if (appli_type_val == '02') {
      options = "<option value>--请选择发票类型--</option><option value='noneed'>无需发票</option><option value='plain'>增值税普通发票（纸质发票）</option>";
    }
    $(appli_invoice_id).html(options);
    $(appli_invoice_id).change();
  });

  $(retroactive_id).unbind('change');
  $(retroactive_id).on("change", function(event) {
    var retroactive_val = '0'
    var checked = $(this).is(':checked');
    if (checked){
      if (!confirm('确定允许此单自动承保新员工吗？')) {
        $(this).prop('checked', false);
        return false;
      }
      retroactive_val = "1"
    } else {
      if (!confirm('确定却取消此单自动承保新员工吗')) {
        $(this).prop('checked', true);
        return false;
      }
      retroactive_val = "0"
    }

    $.ajax({
      type: "POST",
      url: update_price_url,
      data: {update_key: 'with_retroactive_period', update_val: retroactive_val },
      success: function(data){
        console.log( data );
        $(lock_version_id).val( data.lock_version );
        $('#total_price').text( data.price );
      }
    })
  });

  $(filter_text_id).unbind('change');
  $(filter_text_id).on("change", function(event) {
    var text_val = $(filter_text_id).val();
    var url = filter_url + "?filter[value]=" + text_val;
    if ( is_id_exist(filter_flag_id) ) {
      var flag_val = get_selected_value( $(filter_flag_id) );
      url += "&filter[flag]=" + flag_val;
    }
    set_element_attr( $('#filter_submit_id'), 'href', url );
    return true;
  });

  $(filter_flag_id).unbind('change');
  $(filter_flag_id).on("change", function(event) {
    var text_val = $(filter_text_id).val();
    var flag_val = get_selected_value( $(filter_flag_id) );
    url = filter_url + "?filter[value]=" + text_val + "&filter[flag]=" + flag_val;
    set_element_attr( $('#filter_submit_id'), 'href', url );
    return true;
  });

</script>


<div id="insured_employee_modal_placeholder_id">
</div>

  <div id="insurance_business_license_modal_placeholder_id">

<div class="modal" id="insurance_business_license_modal_id" tabindex="-1" role="dialog" aria-labelledby="business_license_label">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form class="form-horizontal form-square" id="insurance_business_business_license_id" enctype="multipart/form-data" action="http://qibao360.com/business_licenses" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
          <h4 class="modal-title" id="business_license_label">上传营业执照</h4>
        </div>

        <div class="modal-body">


          <div class="form-group required">
            <label class="control-label col-sm-2" for="business_license_license">营业执照</label>
            <div class="col-sm-6">
              <input class="form-control qibao-form-control business-license-upload" accept="image/jpeg,image/jpg,image/png" onchange="onFileChange(this, 8, &#39;#insurance_business_license_submit_id&#39;)" type="file" name="business_license[license]" id="business_license_license">
            </div>
          </div>

          <div class="form-group">
            <label class="control-label col-sm-2" for="business_license_business_id">企业ID</label>
            <div class="col-sm-6">
              <input class="form-control qibao-form-control" type="text" value="716897" name="business_license[business_id]" id="business_license_business_id">
            </div>
          </div>

          <div class="form-group">
            <label class="control-label col-sm-2" for="business_license_business_type">企业类型</label>
            <div class="col-sm-6">
              <input class="form-control qibao-form-control" type="text" value="insurance_business" name="business_license[business_type]" id="business_license_business_type">
            </div>
          </div>

        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">放弃上传</button>
          <input type="submit" name="commit" value="开始上传" class="btn btn-primary" id="insurance_business_license_submit_id" data-disable-with="开始上传">
        </div>
</form>    </div>
  </div>
</div>



<script>

    function submitForm(selector) {
        $(selector).click();
    }

    var isIE = /msie/i.test(navigator.userAgent) && !window.opera;
    function onFileChange(target, sizeLimit, submitButtonSelector, not_submit_form, callback) {

        var fileSize = 0;
        if (isIE && !target.files) {
            var filePath = target.value;
            var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
            var file = fileSystem.GetFile(filePath);
            fileSize = file.Size;
        } else {
            fileSize = target.files[0].size;
        }
        var size = fileSize / 1024;
        if (size > sizeLimit * 1000) {
            return alert("附件不能大于" + sizeLimit + "M");
        }

        if (!not_submit_form){
            submitForm(submitButtonSelector);
        }

        if(callback){
            callback();
        }
    }

</script>

</div>



<div id="insured_employee_modal_qrcode_id">
  <div class="modal fade" id="insured_employee_new_qrcode_id" tabindex="-1" role="dialog" aria-labelledby="new_qrcode_label">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="new_qrcode_label">微信扫码收集名单二维码</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
      <div class="modal-body">

          <div class="text-center">
            <div class="qrcode-table qrcode-center">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIAQAAAACFI5MzAAACpElEQVR4nO1YwYrlIBA0q5BvEgw2+FVC4BEQ8lUBRcFvCijZ6jfXnT3sTMMeJpeAQvp1d1V19fv1fPb8Up89Pzf//U1ZFlM2mlRITWrF8IFAHP08GdHWrLNqhfT4OPj+TAt+fR9KzY2UH669D2Qq6ly/t70nf3D1vvq1v91MUvratldyTiqOH6pfe9MXObx14gOBOHNZSPWzpl7P3FP7OPj+OP55xozbruauUDNLfCCDt6azTwgzyUayCxUJ/kyaMYaD0BiwqKYGZDsJnoKeOjtlQ1LOks56uH//2uc3MzzPYRjYMwANM+QSskg+0/ibdM3+ojbDTa41iXx2fS9rhijMMOwODq0i/OnHslZOopAD9GY0FiAXwDVAYE0/dn8eEFIQVdckom9IAwibxobhyg6BKyL5IJCu9wtIu8KZdYJsS+Rj43reG4Cgr7f2MJ8keKr0vfczFxbT5BDDIZgIfxhp9lUxfqjXMQkTQoI/xj8DzJyvgblaoKLRSPBU52LmtpdX6rlsr5p0rSJzAXCGyclovtPokL/hR0Tmgl2Ypoq1LUZqug6JurXGMIZFiCG1fl7bsnBCAj4RMmN3u/ebULO11pol+OMK+cugP6qhgB7o3oKEHszdGp/n+lwh6wpjVYeIvqEnt1E9K3+vA8J9R6Ml8tFjrjdUuhDqFh5YOC/SH1UwqtkeYPa85U0fkUR0lFWnZzc3jAUMH7wk6oa55t9Ko5qyphWUTsRX8frGDqfBv/MIgi4YEZ/I6xu2RlQLJXuDwEr4Xl7fsJS83p4K69xc0CYZf8CanbAAw1EtERC3JBVHD3yb/RQsCI9XiThY39xcsPZccYcsdOjoF3/1H294fYN5b4X7Ag/CPMoCcXh9w5714OWwlMDO898HQv35uZG/+Q2Bb5GH0XSvOgAAAABJRU5ErkJggg==">
              <br>
              <div>扫码收集被保人员名单</div>
              <br>
              <div>扫码转发给被保人员即可</div>
            </div>
          </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-block" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

</div>

<div id="mailing_item_modal_placeholder_id"><!-- Modal -->
<div class="modal fade" id="mailing_item_modal_id" tabindex="-1" role="dialog" aria-labelledby="mailingModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="mailingModalLabel">新增邮寄信息</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="m-2" style="font-size:16px" id="new_mailing_item" action="http://qibao360.com/users/14585/mailing_items" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓">

  <div id="mailing_item_error_placeholder_id">

  </div>


  <div class="form-group row hidden">
    <label class="col-form-label text-right col-2" for="mailing_item_line_item_id">Line item</label>
    <div class="col-3">
      <input class="form-control" readonly="readonly" type="text" value="705839" name="mailing_item[line_item_id]" id="mailing_item_line_item_id">
    </div>
    <label class="col-form-label text-right col-2" for="mailing_item_prev_id">Prev</label>
    <div class="col-3">
      <input class="form-control" readonly="readonly" type="text" name="mailing_item[prev_id]" id="mailing_item_prev_id">
    </div>
  </div>

  <div class="form-group row">
    <label class="col-form-label text-right col-2" for="mailing_item_recipient">收件人姓名</label>
    <div class="col-8">
      <input class="form-control field-recipient" placeholder="填写收件人姓名（中文）" autofocus="autofocus" type="text" name="mailing_item[recipient]" id="mailing_item_recipient">
      <div class="invalid-feedback"></div>
    </div>
  </div>

  <div class="form-group row">
    <label class="col-form-label text-right col-2" for="mailing_item_telephone">收件人电话</label>
    <div class="col-4">
      <input class="form-control field-telephone" placeholder="手机号或0开头固话" type="text" name="mailing_item[telephone]" id="mailing_item_telephone">
      <div class="invalid-feedback"></div>
    </div>
    <div class="col-6 form-text">
      <small class="text-muted">
        手机号或0开头固话（如：021-61533509-7836）
      </small>
    </div>
  </div>

  <div class="form-group row">
    <label class="col-form-label col-form-label text-right col-2" for="mailing_item_province_id">所在省市区</label>
    <div class="col-10">
      <div class="form-row align-items-center">
  <div class="col-auto">
    <select onchange="province_options(this.value)" class="form-control field-province" name="mailing_item[province_id]" id="mailing_item_province_id"><option value="">--省份--</option>
<option value="9">上海市</option>
<option value="10">江苏省</option>
<option value="11">浙江省</option>
<option value="1">北京市</option>
<option value="2">天津市</option>
<option value="3">河北省</option>
<option value="4">山西省</option>
<option value="5">内蒙古自治区</option>
<option value="6">辽宁省</option>
<option value="7">吉林省</option>
<option value="8">黑龙江省</option>
<option value="12">安徽省</option>
<option value="13">福建省</option>
<option value="14">江西省</option>
<option value="15">山东省</option>
<option value="16">河南省</option>
<option value="17">湖北省</option>
<option value="18">湖南省</option>
<option value="19">广东省</option>
<option value="20">广西壮族自治区</option>
<option value="21">海南省</option>
<option value="22">重庆市</option>
<option value="23">四川省</option>
<option value="24">贵州省</option>
<option value="25">云南省</option>
<option value="26">西藏自治区</option>
<option value="27">陕西省</option>
<option value="28">甘肃省</option>
<option value="29">青海省</option>
<option value="30">宁夏回族自治区</option>
<option value="31">新疆维吾尔自治区</option>
<option value="32">台湾省</option>
<option value="33">香港特别行政区</option>
<option value="34">澳门特别行政区</option></select>
    <div class="invalid-feedback"></div>
  </div>

  <div class="col-auto">
      <select onchange="city_options(this.value)" class="form-control field-city" name="mailing_item[city_id]" id="mailing_item_city_id"><option value="1">北京市</option></select>
    <div class="invalid-feedback"></div>
  </div>

  <div class="col-auto">
      <select class="form-control field-district" name="mailing_item[district_id]" id="mailing_item_district_id"><option value="1">东城区</option><option value="2">西城区</option><option value="3">崇文区</option><option value="4">宣武区</option><option value="5">朝阳区</option><option value="6">丰台区</option><option value="7">石景山区</option><option value="8">海淀区</option><option value="9">门头沟区</option><option value="10">房山区</option><option value="11">通州区</option><option value="12">顺义区</option><option value="13">昌平区</option><option value="14">大兴区</option><option value="15">怀柔区</option><option value="16">平谷区</option><option value="17">密云县</option><option value="18">延庆县</option></select>
    <div class="invalid-feedback"></div>
  </div>
</div>


<script type="text/javascript">
  var city_id = "#mailing_item_city_id";
  function province_options(value){
    $.ajax({
      type: "POST",
      url:'/locations/cities',
      data: { province_id: value },
      success: function(data){
        $(city_id).html(data);
        $(city_id).change();
      }
    })
  }

  var district_id = "#mailing_item_district_id";
  function city_options(value){
    $.ajax({
      type: "POST",
      url:'/locations/districts',
      data: { city_id: value },
      success: function(data){
        $(district_id).html(data);
        $(district_id).change();
      }
    })
  }
</script>

    </div>
  </div>

  <div class="form-group row">
    <label class="col-form-label text-right col-2" for="mailing_item_detail_address">详细地址</label>
    <div class="col-8">
      <textarea class="form-control field-detail-address" placeholder="无需重复填写省市区信息" rows="2" name="mailing_item[detail_address]" id="mailing_item_detail_address"></textarea>
      <div class="invalid-feedback"></div>
    </div>
  </div>

  <div class="form-group row hidden">
    <label class="col-form-label text-right col-2" for="mailing_item_enterprise_name">公司名称</label>
    <div class="col-8">
      <input class="form-control" placeholder="公司名称（选填）" type="text" name="mailing_item[enterprise_name]" id="mailing_item_enterprise_name">
    </div>
  </div>

</form>
<script type="text/javascript">

function is_bootstrap_css() {
  return $(".form-group").length != 0;
}

function is_weixin_css() {
  return $(".weui-cell").length != 0;
}

//
// base validation functions
//
function toggle_has_error(ctrl, valid) {
  if (valid) {
    ctrl.removeClass("is-invalid")
  }else{
    ctrl.addClass("is-invalid")
  }
}

function toggle_weixin_error(ctrl, valid) {
  if (valid) {
    ctrl.closest("div.weui-cell").removeClass("weui-cell_warn")
  }else{
    ctrl.closest("div.weui-cell").addClass("weui-cell_warn")
  }
}

function toggle_input_error(ctrl, valid) {
  if (is_bootstrap_css()) {
    toggle_has_error(ctrl, valid);
  } else if (is_weixin_css()) {
    toggle_weixin_error(ctrl, valid);
  }
}

function is_recipient_valid(val) {
  return val != '';
}

function is_recipient_short(val) {
  return val.length < 2;
}

function is_chinese_recipient_valid(name) {
  return isChineseName(name);
}

function verify_recipient_field(ctrl_name) {
  var name = ctrl_name.val();

  var valid = true;
  var tip_text = '';
  if (!is_recipient_valid(name)) {
    valid = false;
    tip_text = '收件人姓名必须填写';
  } else if (is_recipient_short(name)) {
    valid = false;
    tip_text = '收件人姓名至少2个字';
  } else if (!is_chinese_recipient_valid(name)) {
    valid = false;
    tip_text = '收件人姓名必须为汉字';
  } else {
    valid = true;
    tip_text = '';
  }

  var ctrl_help = ctrl_name.closest('.form-group').find('.invalid-feedback');
  ctrl_help.text(tip_text);

  toggle_input_error(ctrl_name, valid);

  return valid;
}

//
// TELEPHONE
//
function verify_telephone_field(ctrl) {
  var tel = ctrl.val();

  var valid = true;
  var tip_text = '';
  if (tel == '') {
    valid = false;
    tip_text = '收件人电话必须填写';
  } else if (!isTelephoneValid(tel)) {
    valid = false;
    tip_text = '收件人电话格式不正确';
  } else {
    valid = true;
    tip_text = '';
  }

  var ctrl_help = ctrl.closest('.form-group').find('.invalid-feedback');
  ctrl_help.text(tip_text);

  toggle_input_error(ctrl, valid);

  return valid;
}

//
// PROVINCE, CITY, DISTRICT
//
function is_select_ctrl_invalid(val) {
  return val == '' || val == undefined;
}

function verify_select_field(ctrl, invalid_text) {
  var val = ctrl.val();

  var valid = !is_select_ctrl_invalid(val);
  var tip_text = '';
  if (!valid) {
    tip_text = invalid_text;
  }

  var ctrl_help = ctrl.closest('.col-auto').find('.invalid-feedback');
  ctrl_help.text(tip_text);

  toggle_input_error(ctrl, valid);

  console.log('select:' + valid);

  return valid;
}

//
// DETAIL ADDRESS
//
function verify_detail_address_field(ctrl) {
  var tel = ctrl.val();

  var valid = true;
  var tip_text = '';
  if (tel == '') {
    valid = false;
    tip_text = '详细地址必须填写';
  } else {
    valid = true;
    tip_text = '';
  }

  var ctrl_help = ctrl.closest('.form-group').find('.invalid-feedback');
  ctrl_help.text(tip_text);

  toggle_input_error(ctrl, valid);

  return valid;
}

$('form').on('keyup change','.field-recipient',function(){
  var ctrl_recipient = $(this);
  verify_recipient_field(ctrl_recipient);
})

$('form').on('keyup change','.field-telephone',function(){
  var ctrl_telephone = $(this);
  verify_telephone_field(ctrl_telephone);
})

$('form').on('change','.field-province',function(){
  var ctrl_province = $('.field-province');
  var valid_province = verify_select_field(ctrl_province, '必须选择所在省');
})

$('form').on('change','.field-city',function(){
  var ctrl_city = $('.field-city');
  var valid_city = verify_select_field(ctrl_city, '必须选择所在市');
})

$('form').on('change','.field-district',function(){
  var ctrl_district = $('.field-district');
  var valid_district = verify_select_field(ctrl_district, '必须选择所在区');
})

$('form').on('keyup change','.field-detail-address',function(){
  var ctrl_detail_address = $(this);
  verify_detail_address_field(ctrl_detail_address);
})


$('form').on('submit', function(e) {

  // verify recipient
  var ctrl_recipient = $('.field-recipient');
  if (!verify_recipient_field(ctrl_recipient)) {
    ctrl_recipient.focus();
    return false;
//  return e.preventDefault;
  }

  // verify telephone
  var ctrl_telephone = $('.field-telephone');
  if (!verify_telephone_field(ctrl_telephone)) {
    ctrl_telephone.focus();
    return false;
  }

  // verify province
  var ctrl_province = $('.field-province');
  var valid_province = verify_select_field(ctrl_province, '必须选择所在省');
  if (!valid_province) {
//  ctrl_province.focus();
  }

  // verify city
  var ctrl_city = $('.field-city');
  var valid_city = verify_select_field(ctrl_city, '必须选择所在市');
  if (!valid_city) {
//  ctrl_city.focus();
  }

  // verify district
  var ctrl_district = $('.field-district');
  var valid_district = verify_select_field(ctrl_district, '必须选择所在区');
  if (!valid_district) {
//  ctrl_district.focus();
  }

  if (!valid_province || !valid_city || !valid_district) {
    return false;
  }

  // verify detail address
  var ctrl_detail_address = $('.field-detail-address');
  if (!verify_detail_address_field(ctrl_detail_address)) {
    ctrl_detail_address.focus();
    return false;
  }

  return true;
});

</script>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
        <input type="submit" name="commit" value="新增邮寄信息" class="btn btn-primary" form="new_mailing_item" data-disable-with="新增邮寄信息">
      </div>
    </div>
  </div>
</div>
</div>

    <form id="insured_employees_destroy_all" action="http://qibao360.com/insurance_items/114025/insured_employees/destroy_all" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓">
</form>


  </div><!-- col-10 -->
</div><!-- row -->



<script type="text/javascript">
$(function(){
  if(window.navigator.appVersion.indexOf('Chrome')>-1){
    $('select[disabled="disabled"]').css({'border-color':'rgb(235,235,235)','color':'rgb(128,128,128)'});
    $('input[disabled="disabled"]').css({'color':'rgb(153,153,153)'});
    $('.form-control-feedback').css({'color':'rgb(153,153,153)'});
  }
})
</script>





  </div>

{%  endblock  %}

     {% block extrajs %}

{% endblock %}

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <!--
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  -->

<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" style="position: absolute; top: 456.333px; left: 333.427px; z-index: 4; display: none;"><div class="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"><a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="&lt;上月"><span class="ui-icon ui-icon-circle-triangle-w">&lt;上月</span></a><a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="下月&gt;"><span class="ui-icon ui-icon-circle-triangle-e">下月&gt;</span></a><div class="ui-datepicker-title"><span class="ui-datepicker-year">2019</span>年&nbsp;<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change"><option value="3" selected="selected">四月</option><option value="4">五月</option><option value="5">六月</option><option value="6">七月</option><option value="7">八月</option><option value="8">九月</option><option value="9">十月</option><option value="10">十一月</option><option value="11">十二月</option></select></div></div><table class="ui-datepicker-calendar"><thead><tr><th scope="col"><span title="星期一">一</span></th><th scope="col"><span title="星期二">二</span></th><th scope="col"><span title="星期三">三</span></th><th scope="col"><span title="星期四">四</span></th><th scope="col"><span title="星期五">五</span></th><th scope="col" class="ui-datepicker-week-end"><span title="星期六">六</span></th><th scope="col" class="ui-datepicker-week-end"><span title="星期日">日</span></th></tr></thead><tbody><tr><td class=" ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">1</span></td><td class=" ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">2</span></td><td class=" ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">3</span></td><td class=" ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">4</span></td><td class=" ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">5</span></td><td class=" ui-datepicker-week-end ui-datepicker-unselectable ui-state-disabled undefined ui-datepicker-today"><span class="ui-state-default">6</span></td><td class=" ui-datepicker-week-end ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">7</span></td></tr><tr><td class=" ui-datepicker-unselectable ui-state-disabled undefined"><span class="ui-state-default">8</span></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">9</a></td><td class=" undefined ui-datepicker-current-day" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default ui-state-active" href="http://qibao360.com/insurance_items/114025/edit#">10</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">11</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">12</a></td><td class=" ui-datepicker-week-end undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">13</a></td><td class=" ui-datepicker-week-end undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">14</a></td></tr><tr><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">15</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">16</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">17</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">18</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">19</a></td><td class=" ui-datepicker-week-end undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">20</a></td><td class=" ui-datepicker-week-end undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">21</a></td></tr><tr><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">22</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">23</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">24</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">25</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">26</a></td><td class=" ui-datepicker-week-end undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">27</a></td><td class=" ui-datepicker-week-end undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">28</a></td></tr><tr><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">29</a></td><td class=" undefined" data-handler="selectDay" data-event="click" data-month="3" data-year="2019"><a class="ui-state-default" href="http://qibao360.com/insurance_items/114025/edit#">30</a></td><td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-week-end ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td><td class=" ui-datepicker-week-end ui-datepicker-other-month ui-datepicker-unselectable ui-state-disabled">&nbsp;</td></tr></tbody></table></div>


</body>


<!-- Mirrored from qibao360.com/insurances/125 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 24 Mar 2019 08:43:30 GMT -->
</html>
